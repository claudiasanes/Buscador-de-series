"use strict";let showsList=[],favorites=getFavoritesLocalStorage();function init(){document.querySelector(".search").addEventListener("submit",getShowsData),paintFavorites()}function getShowsData(e){e.preventDefault();const t=document.querySelector(".input").value;fetch("http://api.tvmaze.com/search/shows?q="+t).then(e=>e.json()).then(e=>{showsList=e,paintShowsList()})}function notFound(){return'<p class="empty-state"> No hemos encontrado la serie que buscas, prueba de nuevo ðŸ˜Š</p>'}function checkImg(e){return null===e?"https://via.placeholder.com/210x270/ffffff/666666/?text=TV":e.medium}function paintShowsList(){const e=document.querySelector(".shows-container");let t="";if(showsList.length)for(let e=0;e<showsList.length;e++){let s="bg-normal";isFavorite(showsList[e].show.id)&&(s="bg-clicked"),t+=`<li class="show-preview ${s}" id="${showsList[e].show.id}">`,t+='<div class="poster-container">',t+=`<img src="${checkImg(showsList[e].show.image)}" title="show poster" class="show-image" /> `,t+="</div>",t+=`<p class="show-tittle color-normal">${showsList[e].show.name}</p> `,t+="</li>"}else t=notFound();e.innerHTML=t,addShowsListeners()}function addShowsListeners(){let e=document.querySelectorAll(".shows-container li");for(const t of e)t.addEventListener("click",favoritesHandler)}function favoritesHandler(e){addToFavorites(e.currentTarget)}function isFavorite(e){return-1!==favorites.findIndex(t=>t.show.id===e)}function addToFavorites(e){const t=parseInt(e.id);if(isFavorite(t))e.classList.remove("bg-clicked"),e.classList.add("bg-normal"),removeFavorite(t);else{const s=showsList.find(e=>e.show.id===t);e.classList.add("bg-clicked"),e.classList.remove("bg-normal"),addFavorite(s)}}function addFavorite(e){favorites.push(e),setLocalStorage(favorites),paintFavorites()}function removeFavorite(e){favorites=favorites.filter(t=>t.show.id!==e),setLocalStorage(favorites),paintFavorites()}function setLocalStorage(e){localStorage.setItem("favs",JSON.stringify(e))}function getFavoritesLocalStorage(){let e=JSON.parse(localStorage.getItem("favs"));return null!==e?e:[]}function paintFavorites(){const e=document.querySelector(".fav-container");let t="";for(let e=0;e<favorites.length;e++)t+='<li class="fav-preview ">',t+='<div class="fav-obj-container">',t+='<div class="fav-poster-container">',t+=`<img src="${checkImg(favorites[e].show.image)}" tittle="favorite show poster" class="fav-image" />`,t+="</div>",t+=`<p class="fav-tittle">${favorites[e].show.name}</p>`,t+="</div>",t+=`<button class="remove-btn" id="${favorites[e].show.id}"> X </button>`,t+=" </li>";e.innerHTML=t,addFavsListeners(),addResetListener()}function addFavsListeners(){let e=document.querySelectorAll(".remove-btn");for(const t of e)t.addEventListener("click",favoriteClickHandler)}function favoriteClickHandler(e){removeFavorite(parseInt(e.currentTarget.id)),paintShowsList(),paintFavorites()}function addResetListener(){document.querySelector(".reset-btn").addEventListener("click",resetClickHandler)}function resetClickHandler(){favorites=[],paintFavorites(),setLocalStorage(favorites),paintShowsList()}init();