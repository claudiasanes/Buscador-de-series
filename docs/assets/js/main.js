"use strict";let showsList,favorites;function init(){showsList=[],favorites=getFavoritesLocalStorage();document.querySelector(".search").addEventListener("submit",getShowsData),paintFavorites()}function getShowsData(t){t.preventDefault();const e=document.querySelector(".input").value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(t=>t.json()).then(t=>{showsList=t,paintShowsList()})}function notFound(){return"No hemos encontrado la serie que buscas, prueba de nuevo :)"}function checkImg(t){return null===t?"https://via.placeholder.com/210x270/ffffff/666666/?text=TV":t.medium}function paintShow(t){let e="bg-normal";return isFavorite(t.show.id)&&(e="bg-clicked"),`\n   <li class="show-preview ${e}" id="${t.show.id}">\n    <div class="poster-container">\n      <img src="${checkImg(t.show.image)}" title="show poster" class="show-image" /> \n    </div>\n  <p class="show-tittle color-normal">${t.show.name}</p> \n  </li>`}function paintShowsList(){const t=document.querySelector(".shows-container");let e="";if(0===showsList.length)e=notFound();else for(let t=0;t<showsList.length;t++)e+=paintShow(showsList[t]);t.innerHTML=e,addShowsListeners()}function addShowsListeners(){let t=document.querySelectorAll(".shows-container li");for(const e of t)e.addEventListener("click",favoritesHandler)}function favoritesHandler(t){addToFavorites(t.currentTarget)}function isFavorite(t){return-1!==favorites.findIndex(e=>e.show.id===t)}function addToFavorites(t){const e=parseInt(t.id);if(isFavorite(e))t.classList.remove("bg-clicked"),t.classList.add("bg-normal"),removeFavorite(e);else{const o=showsList.find(t=>t.show.id===e);t.classList.add("bg-clicked"),t.classList.remove("bg-normal"),addFavorite(o)}}function addFavorite(t){favorites.push(t),setLocalStorage(favorites),paintFavorites()}function removeFavorite(t){favorites=favorites.filter(e=>e.show.id!==t),setLocalStorage(favorites),paintFavorites()}function setLocalStorage(t){localStorage.setItem("favs",JSON.stringify(t))}function getFavoritesLocalStorage(){let t=JSON.parse(localStorage.getItem("favs"));return null!==t?t:[]}function paintFavorite(t){return`\n    <li class="fav-preview ">\n    <div class="fav-obj-container">\n      <div class="fav-poster-container">\n      <img src="${checkImg(t.show.image)}" tittle="favorite show poster" class="fav-image" />\n      </div>\n      <p class="fav-tittle">${t.show.name}</p>\n      </div>\n      <button class="remove-btn" id="${t.show.id}"> X </button>\n    </li>\n   \n  `}function paintFavorites(){const t=document.querySelector(".fav-container");let e="";for(let t=0;t<favorites.length;t++)e+=paintFavorite(favorites[t]);t.innerHTML=e,addFavsListeners()}function addFavsListeners(){let t=document.querySelectorAll(".remove-btn");for(const e of t)e.addEventListener("click",favoriteClickHandler)}function favoriteClickHandler(t){removeFavorite(parseInt(t.currentTarget.id)),paintShowsList(),paintFavorites()}init();