"use strict";let showsList=[],favorites=getFavoritesLocalStorage();function init(){document.querySelector(".search").addEventListener("submit",getShowsData),paintFavorites()}function getShowsData(t){t.preventDefault();const e=document.querySelector(".input").value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(t=>t.json()).then(t=>{showsList=t,paintShowsList()})}function notFound(){return'<p class="empty-state"> No hemos encontrado la serie que buscas, prueba de nuevo ðŸ˜Š</p>'}function checkImg(t){return null===t?"https://via.placeholder.com/210x270/ffffff/666666/?text=TV":t.medium}function paintShowsList(){const t=document.querySelector(".shows-container");let e="";for(let s=0;s<showsList.length;s++){if(0===showsList.length)e=notFound();else{let t="bg-normal";isFavorite(showsList[s].show.id)&&(t="bg-clicked"),e+=`<li class="show-preview ${t}" id="${showsList[s].show.id}">`,e+='<div class="poster-container">',e+=`<img src="${checkImg(showsList[s].show.image)}" title="show poster" class="show-image" /> `,e+="</div>",e+=`<p class="show-tittle color-normal">${showsList[s].show.name}</p> `,e+="</li>"}t.innerHTML=e}addShowsListeners()}function addShowsListeners(){let t=document.querySelectorAll(".shows-container li");for(const e of t)e.addEventListener("click",favoritesHandler)}function favoritesHandler(t){addToFavorites(t.currentTarget)}function isFavorite(t){return-1!==favorites.findIndex(e=>e.show.id===t)}function addToFavorites(t){const e=parseInt(t.id);if(isFavorite(e))t.classList.remove("bg-clicked"),t.classList.add("bg-normal"),removeFavorite(e);else{const s=showsList.find(t=>t.show.id===e);t.classList.add("bg-clicked"),t.classList.remove("bg-normal"),addFavorite(s)}}function addFavorite(t){favorites.push(t),setLocalStorage(favorites),paintFavorites()}function removeFavorite(t){favorites=favorites.filter(e=>e.show.id!==t),setLocalStorage(favorites),paintFavorites()}function setLocalStorage(t){localStorage.setItem("favs",JSON.stringify(t))}function getFavoritesLocalStorage(){let t=JSON.parse(localStorage.getItem("favs"));return null!==t?t:[]}function paintFavorites(){const t=document.querySelector(".fav-container");let e="";for(let t=0;t<favorites.length;t++)e+='<li class="fav-preview ">',e+='<div class="fav-obj-container">',e+='<div class="fav-poster-container">',e+=`<img src="${checkImg(favorites[t].show.image)}" tittlefavorites[i]orite show poster" class="fav-image" />`,e+="</div>",e+=`<p class="fav-tittle">${favorites[t].show.name}</p>`,e+="</div>",e+=`<button class="remove-btn" id="${favorites[t].show.id}"> X </button>`,e+=" </li>";t.innerHTML=e,addFavsListeners()}function addFavsListeners(){let t=document.querySelectorAll(".remove-btn");for(const e of t)e.addEventListener("click",favoriteClickHandler)}function favoriteClickHandler(t){removeFavorite(parseInt(t.currentTarget.id)),paintShowsList(),paintFavorites()}init();